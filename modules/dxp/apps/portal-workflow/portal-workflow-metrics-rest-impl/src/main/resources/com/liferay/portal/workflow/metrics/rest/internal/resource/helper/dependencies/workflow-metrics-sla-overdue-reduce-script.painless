def map = new HashMap();
def onTimeMap;

for (state in states) {
	if (state == null) {
		continue;
	}

	onTimeMap = state.onTimeMap;

	for (entry in onTimeMap.entrySet()) {
		map.merge(
			entry.key, entry.value, (onTime1, onTime2) -> onTime1 && onTime2);
	}
}

def instanceCount = 0;

for (entry in map.entrySet()) {
	if (entry.value == false) {
		instanceCount += 1;
	}
}

return instanceCount;